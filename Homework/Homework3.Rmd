---
title: "Homework 3 - Multiple Regression"
author: "Natalie Sawtelle"
date: "2025-10-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(GGally)
library(ggfortify)
library(emmeans)
```

## Problem 1

Data Description: Measurements on human blood properties were collected in an effort to build a model to determine the relationship with heart functions, as measured by the pulse rate. The following variables are in the dataset:

HDL: High-Density Lipoprotein (HDL) cholesterol.
LDL: Low-Density Lipoprotein (LDL) cholesterol
WHITE: White blood cell count  - the number of white blood cells (leukocytes) (in thousands per microliter (µL) of blood). 
PLATE: Platelet count - a measure of the number of platelets in your blood (in thousands per microliter of blood)
PULSE: Resting Pulse rate - measured in beats per minute. 

Part 1: Read in the data. Construct a scatterplot matrix of all variables in the data.  Describe any discernible patterns you see.

```{r body data}
body_data <- read_csv("Body Data.csv", 
                         show_col_types=FALSE)
glimpse(body_data)
```


```{r scatter, fig.width=10, fig.height=10, message=FALSE, warning=FALSE, echo=FALSE}
ggpairs(body_data, columns = c(2:5,1))
```

**Overall, WHITE appears to be the most promising predictor of pulse rate since it has a moderatly positive correlation with both PLATE and PULSE, while HDL, LDL, and PLATE show weaker direct relationships.**

Part 2: Fit a multiple regression modeling PULSE as a function of LDL,  HDL, WHITE, and PLATE. Perform a residual analysis of the fitted model. Do you see any concerns regarding the assumptions we make in linear regression?


```{r regression model}
body_fit <- lm(PULSE ~ LDL + HDL + WHITE + PLATE, data= body_data)
summary(body_fit)
```

```{r plots, message=FALSE}
autoplot(body_fit)
```

**Overall, the assumptions of linear regression are satisfied. The Normal Q–Q plot appears roughly linear and the Residuals vs Fitted plot show a random scatter around zero with no strong pattern. Therefore, I do not have any concerns.**

Part 3: Determine if your fitted model from Part 2 significantly predicts pulse rates.


```{r body anova}
anova(body_fit)
```

**The fitted multiple regression model significantly predicts pulse rates at the 5% significance level, primarily due to the contribution of the WHITE variable since it has a highly significant effect on pulse.**

Part 4: Interpret the intercept term for the fitted model from part 2. Does it contextually make any sense?

**The intercept from the fitted model is 59.107010. This represents the predicted pulse rate when all predictor varibale are equal to zero. Contexually this does not make sense since this would be biologically impossible. This number is only used for modeling purposes, and can not be interpretated in the real world.**

Part 5: Interpret the residual standard error and $R^2$ of the multiple regression model created in part 2.

**Since the RSE is 11.94, the model is approximately off by 12 beats per minute. The multiple r-sqared value is 0.04349, meaning that only about 4.35% of the variation in pulse rate is explained by LDL, HDL, WHITE, and PLATE.**

Part 6: Create and interpret a 99% confidence interval for the coefficient on the WHITE blood cell variable. 

```{r confidence interval}
confint(body_fit, level=0.99)["WHITE", ]
```

**We are 99% confident that while holding LDL, HDL, and PLATE constant, the true increase in pulse rate for each one-unit increase in white blood cell count is between 0.12 and 2.14 beats per minute.**

Part 7: Why would white blood cells predict pulse rates?

**White blood cells increase during inflammation, infection, or stress. Physiology states that they can also elevate heart rate and pulse. Therefore, a higher white blood cell count could correspond with an elevated pulse rate due to the body’s immune or stress response.**

Part 8: Dr. Fisher went to the doctor and a sample of blood was collected for analysis (the results are reported below). Use this information to predict Dr. Fisher's pulse rate with a 95% prediction interval.

HDL: 51
LDL: 123
WHITE: 10.4
PLATE: 337

```{r Dr. Fisher}
new_body <- data.frame(
  LDL=123, 
  HDL=51,
  WHITE=10.4, 
  PLATE=337)

predict(body_fit, newdata=new_body, interval="prediction", level=0.95)
```

**The model predicts Dr. Fisher’s pulse rate to be approximately 77.29 beats per minute, with a 95% prediction interval from 53.55 to 101.02 bpm.**


## Problem 2

Dataset Overview

This dataset contains a random selection of 100 coffee shops, offering detailed insights into factors that influence daily revenue. It includes key operational and environmental variables that provide a comprehensive view of how business activities and external conditions affect sales performance. Designed for use in predictive analytics and business optimization, this dataset is a valuable resource for anyone looking to understand the relationship between customer behavior, operational decisions, and revenue generation in the food and beverage industry.

Number of Customers Per Day

The total number of customers visiting the coffee shop on any given day.
Range: 50 - 500 customers.
Average Order Value ($)

The average dollar amount spent by each customer during their visit.
Range: 2.50 - 10.00 dollars.
Marketing Spent Per Day ($)

The amount of money spent on marketing campaigns or promotions on any given day.
Range: 10 - 500 dollarts per day.
Location Foot Traffic (people/hour)

The number of people passing by the coffee shop per hour, a variable indicative of the shop's location and its potential to attract customers.
Range: 50 - 1000 people per hour.
Daily Revenue ($)

The total revenue generated by the coffee shop each day
Range: 200 - 10,000 dollars per day.

Part 1: Read in the data. Perform an appropriate Exploratory Data Analysis.

```{r coffee data}
coffee_data <- read_csv("Coffee.csv", 
                         show_col_types=FALSE)
glimpse(coffee_data)

```

```{r EDA, message=FALSE}
ggpairs(coffee_data)
```

**Daily revenue is most strongly influenced by the number of customers and average order, due to their strong positive correlations. Marketing expenditure has a moderate positive effect, while foot traffic seems to have little to no direct relationship.**

Part 2: Fit a full model to predict the Daily Revenue of a cafe. Conduct appropriate residual analysis before preforming the necessary hypothesis testing. 

```{r coffee full fit}
coffee_model <- lm(Daily_Revenue ~ Average_Order +  Marketing + 
                       Foot_Traffic, data=coffee_data)
autoplot(coffee_model)
```

**Overall, the assumptions of linear regression are satisfied. The Normal Q–Q plot appears roughly linear and the Residuals vs Fitted plot show a random scatter around zero with no strong pattern. Therefore, I do not have any concerns.**

```{r anova}
anova(coffee_model)
```

**Average Order Value and Marketing Spending have statistically significant effects on Daily Revenue since their p-values are less than 0.001. However, Foot Traffic does not have a significant effect on Daily Revenue since its p-value is greater than 0.001.**

Part 3: Assess the “Goodness of Fit” for the model by interpreting/explaining at least two measures of error for the model. 

```{r goodness}
summary(coffee_model)
```

**The Multiple r-squared indicates that approximately 39.2% of the variation in Daily Revenue is explained by the predictors and the RSE shows that on average, the model’s predictions are off by about $863 per day. Both of these value affirm that the model provides a reasonable fit to the data.**

Part 4: What variables are conditionally significant? Conduct and interpret Bonferroni adjusted confidence intervals for the conditionally significant variables. (Adjust the confidence level based on the total number of predictors in the model, but you only need to interpret the intervals for the predictors that are conditionally significant.) 

**Both Average Order and Marketing are conditionally significant.**

```{r bonferroni}
confint(coffee_model, level = 1-0.05/3)
```

**We are 98.33% confident that as the average order value increases by $1, revenue increases by approximately $251.**
**We are 98.33% confident that for every additional $1 spent on marketing per day, daily revenue increases by about $2.26.**

Part 5: You are the owner of a cafe with the following inputs. Predict your Daily Revenue.

Number of Customers Per Day: 285
Average Order Value (dollars): 6.32 dollars
Marketing Spend Per Day (dollars): 240 dollars
Location Foot Traffic (people/hour): 502

```{r coffee predict}
new_cafe <- data.frame(
  Average_Order = 6.32,
  Marketing = 240,
  Foot_Traffic = 502
)

predict(coffee_model, newdata = new_cafe, interval = "prediction")
```

**The model predicts Daily Revenue to be approximately $2,003, with a 95% prediction interval from from $282 to $3,724.**

Part 6: Suppose you are the owner of a coffee shop and on a given day you notice that your profits are 100 dollars less than normal. You don’t want to adjust costs of menu items for fear of turning your customers away. Instead, you consider adjusting your marketing amounts since that is the only other variable in which you have direct input. How much do you need to spend in order for your profit to make up for that 100 dollars? Note increasing the amount spent on marketing will also increase your operational costs. Make sure your increase in revenue will cover this additional cost such that your net profit will increase by at least 100 dollars. 

Hint: Use the prediction inputs from above and adjust the marketing amount from there. Hold all other variables constant. 

Other notes:

From Basic economics: Profit = Revenue - Cost.  When Cost > Revenue, Profit is negative and you are losing money. 
This scenario is clearly fictional and we are ignoring the interaction of the predictor variables - with more advertising, we should see an increase in the number of customers & foot traffic.  We are ignoring these effects in the problem.
Also, for the sake of completing this problem, you can assume you have enough capital to spend more on advertising to reach your goal of $100 more in profit.

```{r part 6}
ew_cafe <- data.frame(
  Average_Order = 6.32,
  Marketing = 240,
  Foot_Traffic = 502
)

predict(coffee_model, newdata = new_cafe, interval = "prediction")

coef(coffee_model)
b2 <- coef(coffee_model)["Marketing"]
x <- 240 + 100 / (b2 - 1)
x
```

**According to the model, to increase net profit by $100, while holding other variables constant, you must spend an additional $79.14 on marketing.**








